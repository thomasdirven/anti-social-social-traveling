<div fxLayout="column" fxLayoutGap="2%">
  <app-add-trip (newTrip)="addNewTrip($event)"></app-add-trip>
  <mat-card>
    <mat-form-field>
      <input
        matInput
        placeholder="city to filter on"
        type="text"
        (keyup)="this.filterTrip$.next($event.target.value)"
        #filterValue
      />
      <button
        mat-button
        *ngIf="filterTripCity"
        matSuffix
        mat-icon-button
        aria-label="Clear"
        (click)="this.filterTrip$.next('')"
        (click)="filterValue.value = ''"
      >
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
    <span> &nbsp; | &nbsp; </span>
    <!-- <form [formGroup]="tripFilterDateRangeFG"> -->
    <mat-form-field appearance="fill">
      <mat-label>Filter on date range</mat-label>
      <mat-date-range-input [rangePicker]="picker">
        <input
          matStartDate
          placeholder="Start date"
          (dateInput)="inputEventStartDate($event)"
        />
        <input
          matEndDate
          placeholder="End date"
          (dateInput)="inputEventEndDate($event)"
        />
      </mat-date-range-input>
      <mat-datepicker-toggle
        matSuffix
        [for]="picker"
      ></mat-datepicker-toggle>
      <mat-date-range-picker #picker></mat-date-range-picker>
<!-- 
      <mat-error
        *ngIf="tripFG.controls.startDate.hasError('matStartDateInvalid')"
        >Invalid start date</mat-error
      >
      <mat-error
        *ngIf="tripFG.controls.endDate.hasError('matEndDateInvalid')"
        >Invalid end date</mat-error
      > -->
    </mat-form-field>
  <!-- </form> -->
  </mat-card>

  <!-- card that allows you to geocode location and put marker on map -->
  <!-- <app-geocode></app-geocode> -->
  <!-- turned of to save free credit on https://console.cloud.google.com/ -->

  <!-- if statement no longer working -->
  <!-- because behaviorObservables are never empty? -->
  <!-- <div *ngIf="trips$ | async as trips; else loadingOrError"> -->
  <div *ngIf="trips$ | async as trips">
    <div *ngIf="trips.length > 0; else loadingOrError">
      <div
        fxLayout="row wrap"
        fxLayout.xs="column"
        fxLayoutGap=""
        fxLayoutAlign="center"
      >
        <div
          class="trip"
          *ngFor="let trip of trips | tripFilter: filterTripCity | tripDateRangeFilter: filterTripDateRange"
          fxFlex="0 0 calc(33%-0.5)"
          fxFlex.xs="100%"
        >
        <!-- is hoverTrip a local variable in this html file?? -->
        <!-- it works, but how? -->
          <app-trip
            [trip]="trip"
            (mouseenter)="hoverTrip = trip"
            (mouseleave)="hoverTrip = null"
          ></app-trip>
        </div>
      </div>
    </div>
    <ng-template #loadingOrError>
      <mat-card class="error" *ngIf="errorMessage; else loading">
        Error loading the city trip list: {{ errorMessage }}. <br />
        Please try again later.
      </mat-card>
      <ng-template #loading>
        <mat-spinner></mat-spinner>
      </ng-template>
    </ng-template>
    <!-- shows google maps on webpage with markers of trip locations -->
    <app-gmap
      [trips]="trips | tripFilter: filterTripCity | tripDateRangeFilter: filterTripDateRange"
      [hoverTrip]="this.hoverTrip"
    ></app-gmap>
    <!-- turned of to save free credit on https://console.cloud.google.com/ -->
  </div>
</div>
